<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stream Awesome - The Stream Deck Icon Generator using Font Awesome</title>
    <link rel="stylesheet" href="fontawesome/css/all.css">
    <style type="text/css">
        body {
            background: #222;
            color:#FFF;
        }
    </style>
</head>

<body>

    <!-- This is required so the browser actually loads the font, lol -->
    <div id="greeting">Hello World! 
        <i class="fas fa-glasses"></i>
        <i class="far fa-glasses"></i>
        <i class="fal fa-glasses"></i>
        <i class="fad fa-glasses"></i>
    </div>

    <div id="content">
        <canvas id="main" width=256 height=256>
        </canvas>
    </div>

    <script>

        // TODO: Give Hue-Value and calculate the shift of the colors yo
        // TODO: Make button to save ass
        // TODO: measureText();

        function rgbToHsl(r, g, b) {
            r /= 255; g /= 255; b /= 255;
            let max = Math.max(r, g, b);
            let min = Math.min(r, g, b);
            let d = max - min;
            let h;
            if (d === 0) h = 0;
            else if (max === r) h = (g - b) / d % 6;
            else if (max === g) h = (b - r) / d + 2;
            else if (max === b) h = (r - g) / d + 4;
            let l = (min + max) / 2;
            let s = d === 0 ? 0 : d / (1 - Math.abs(2 * l - 1));
            return [h * 60, s, l];
        }

        function hslToRgb(h, s, l) {
            let c = (1 - Math.abs(2 * l - 1)) * s;
            let hp = h / 60.0;
            let x = c * (1 - Math.abs((hp % 2) - 1));
            let rgb1;
            if (isNaN(h)) rgb1 = [0, 0, 0];
            else if (hp <= 1) rgb1 = [c, x, 0];
            else if (hp <= 2) rgb1 = [x, c, 0];
            else if (hp <= 3) rgb1 = [0, c, x];
            else if (hp <= 4) rgb1 = [0, x, c];
            else if (hp <= 5) rgb1 = [x, 0, c];
            else if (hp <= 6) rgb1 = [c, 0, x];
            let m = l - c * 0.5;
            return [
                Math.round(255 * (rgb1[0] + m)),
                Math.round(255 * (rgb1[1] + m)),
                Math.round(255 * (rgb1[2] + m))];
        }

        //console.log(hslToRgb(0,1,0.5));

        function doThings(icon) {
            const canvas = document.getElementById("main");
            const ctx = canvas.getContext('2d');

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = "#152409";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = "#74E735";
            ctx.globalAlpha = 1;

            ctx.textBaseline = 'middle';
            ctx.textAlign = "center";
            ctx.font = '900 170px "Font Awesome 5 Pro"';
            ctx.fillText(icon, 128, 128);
            //ctx.fillText(String.fromCharCode(parseInt(icon, 16)), 128, 128);

            //ctx.font = '30px Arial';
            //ctx.fillText("Hello World!", 50, 200);

            //let text = ctx.measureText(icon);
            //console.log(text);

            console.log(document.fonts.check("900 16px 'Font Awesome 5 Pro'") ? "Pro is available" : "Pro is unavailable.");
        }

        document.fonts.ready.then(() => doThings('\u{f039}'));
    </script>
</body>

</html>